---
title: "Recurrent Neural Network"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Recurrent Neural Network}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Package

This package includes an example Recurrent Neural Network.
The package is loaded using:

```{r package}
library(rnn)
```

# Code

We can view the code of the main `rnn()` function by calling it without the parathesis (not printed here).

```{r code-rnn, eval=FALSE}
trainr
```

As can be seen from the above, the model relies on two other functions that are included with the package.

The first function is `sigmoid()`, which converts an integer to its sigmoid value.

```{r sigmoid}
(a <- sigmoid(3))
```

The code for the `sigmoid()` function is:

```{r sigmoid-code}
sigmoid
```

The second function converts the sigmoid value of a number to its derivative.

```{r sigmoid-der}
sigmoid_output_to_derivative(a) # a was created above using sigmoid()
```

Finally, we can inspect this code using:

```{r sigmoid-der-code}
sigmoid_output_to_derivative
```

# Application

By setting a **seed** for the random number generator, we ensure replicability.

```{r seed}
set.seed(1)
```

An example is included in the help file.

```{r help, eval=FALSE}
help('trainr')
```

First we generate the data:

```{r data}
# create sample inputs
X1 = sample(0:127, 5000, replace=TRUE)
X2 = sample(0:127, 5000, replace=TRUE)

# create sample output
Y <- X1 + X2
```

This example is:

```{r example}
# train the model
m1 <- trainr(Y,
             X1,
             X2,
             binary_dim =  8,
             alpha      =  0.1,
             input_dim  =  2,
             hidden_dim = 10,
             output_dim =  1   )
```

Now create testing data

```{r test-data}
# create test inputs
A1 = sample(0:127, 7000, replace=TRUE)
A2 = sample(0:127, 7000, replace=TRUE)
```

Predict based on testing data.

```{r predictr}
B  <- predictr(m1,
               A1,
               A2,
               binary_dim =  8,
               alpha      =  0.1,
               input_dim  =  2,
               hidden_dim = 10,
               output_dim =  1   )
```

Test prediction against true values

```{r test}
hist(B-(A1+A2))
```

## hyperparameters

It is also interesting to vary the number of hidden units and iterations.

```{r example-2}
# create sample inputs
X1 = sample(0:127, 20000, replace=TRUE)
X2 = sample(0:127, 20000, replace=TRUE)

# create sample output
Y <- X1 + X2

# train the model
m2 <- trainr(Y,
             X1,
             X2,
             binary_dim =  8,
             alpha      =  0.1,
             input_dim  =  2,
             hidden_dim =  3,
             output_dim =  1   )
```
